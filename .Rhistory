summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 10) %>%
pull(name)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "received", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top10_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 10)
View(top10_ana_to_bact)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "received", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top20_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "received", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top20_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top20_ana_to_bact) %>%
mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top20_ana_to_bact, unique(name)))]))
View(top_ana_bact_flux_df)
View(top_ana_bact_flux_df)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "received", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "received", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median, .desc = TRUE))
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median))
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
View(M01_ana_to_bac)
View(top10_ana_to_bact)
View(top_ana_bact_flux_df)
View(M01_ana_bac_ints)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median))
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "darkgreen") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2, color = "grey") +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue", name = "Sample Collection Date") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top 10 Metabolites by Median Flux (Anaerostipes → Bacteroides)",
x = "Flux",
y = "Metabolite"
) +
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top 10 Metabolites provided from Anaerostipes to Bacteroides",
x = "Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median)) %>%
mutate(log_flux = log10(flux + 1e-6)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median))
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6)) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median))
p <- ggplot(top_ana_bact_flux_df, aes(x = flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
M01_sick_day <- 1203465600
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6)) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median)) %>%
mutate(ill_onset = efense(sample_id < M01_sick_day, "Before", "After"))
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
M01_sick_day <- 1203465600
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6)) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median)) %>%
mutate(ill_onset = ifelse(sample_id < M01_sick_day, "Before", "After"))
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
#scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
#scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
#scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
#scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
p <- ggplot(top_ana_bact_flux_df, aes(x = log_flux, y = name, color = sample_id)) +
geom_jitter(width = 0, height = 0.2, alpha = 0.6, size = 2) +
stat_summary(fun = median, geom = "crossbar", width = 0.5, color = "black") +
#scale_color_gradient(low = "lightblue", high = "darkblue") +
facet_wrap(~ ill_onset, ncol = 1) +
labs(
title = "Top Metabolites provided from Anaerostipes to Bacteroides",
x = "Log Flux",
y = "Metabolite"
) +
theme(plot.title = element_text(size = 14))
theme_minimal(base_size = 14)
p
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_prev_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Prevotella", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
M01_ana_to_prev <- M01_ana_bac_ints[M01_ana_prev_ints$class == "provided", 1:7]
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
M01_sick_day <- 1203465600
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6)) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median)) %>%
mutate(ill_onset = ifelse(sample_id < M01_sick_day, "Before", "After"))
View(M01_ana_to_prev)
View(M01_ana_to_prev)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_prev_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Prevotella", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
M01_ana_to_prev <- M01_ana_prev_ints[M01_ana_prev_ints$class == "provided", 1:7]
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
M01_sick_day <- 1203465600
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6)) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median)) %>%
mutate(ill_onset = ifelse(sample_id < M01_sick_day, "Before", "After"))
View(M01_anaerostipes_bacteroides)
View(M01_anaerostipes_interactions)
M01_ana_bac_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Bacteroides", ]
M01_ana_prev_ints <- M01_anaerostipes_interactions[M01_anaerostipes_interactions$partner == "g__Prevotella", ]
M01_ana_to_bac <- M01_ana_bac_ints[M01_ana_bac_ints$class == "provided", 1:7] #leaving out some of the extra info
M01_ana_to_prev <- M01_ana_prev_ints[M01_ana_prev_ints$class == "provided", 1:7]
#choose top 10 based on median flux (could change how I'm calling top 10, this seems good for now)
top_ana_to_bact <- M01_ana_to_bac %>%
group_by(name) %>%
summarize(median_flux = median(flux)) %>%
arrange(desc(median_flux)) %>%
slice_head(n = 20) %>%
pull(name)
M01_sick_day <- 1203465600
top_ana_bact_flux_df <- M01_ana_to_bac %>%
filter(name %in% top_ana_to_bact) %>%
mutate(log_flux = log10(flux + 1e-6)) %>%
#mutate(name = factor(name, levels = top20_ana_to_bact[order(-match(top_ana_to_bact, unique(name)))]))
mutate(name = fct_reorder(name, flux, .fun = median)) %>%
mutate(ill_onset = ifelse(sample_id < M01_sick_day, "Before", "After"))
View(M01_anaerostipes_interactions)
View(M01_growth_rates)
